def get_rewrite_feedback_prompt(content_type: str) -> str:
    """
    生成重写反馈提示词
    
    Args:
        content_type: 内容类型（outline/characters/content）
        
    Returns:
        重写反馈提示词
    """
    if content_type == 'characters':
        return """请对人物设定进行分析并给出修改建议，要求：

1. 人物性格分析
   - 评估每个人物性格的立体性
   - 指出性格特征的优缺点
   - 分析性格是否符合人物背景

2. 人物关系分析
   - 评估人物关系的合理性
   - 分析关系网络的完整性
   - 指出关系发展的可能性

3. 人物成长空间
   - 分析人物的成长潜力
   - 评估成长轨迹的设计
   - 建议可能的成长方向

4. 修改建议
   - 针对性格设定的具体建议
   - 关于人物关系的改进方案
   - 成长轨迹的优化建议

请按以上四个方面详细分析并给出具体的修改建议。"""
    
    elif content_type == 'content':
        return """请对内容进行分析并给出修改建议，重点关注：

1. 人物塑造
   - 人物性格表现是否一致
   - 人物行为是否合理
   - 人物对话是否特色
   - 人物互动是否自然
   - 人物成长是否明显

2. 情节发展
   - 故事结构是否完整
   - 情节转折是否合理
   - 冲突设置是否到位
   - 节奏把控是否适当

3. 场景描写
   - 环境描写是否生动
   - 细节刻画是否精准
   - 氛围营造是否到位

4. 主题表达
   - 主题是否明确
   - 情感是否真挚
   - 价值观是否正面

5. 写作技巧
   - 叙事视角是否统一
   - 语言风格是否一致
   - 过渡是否自然

请针对以上几点进行详细分析，并给出具体的修改建议。"""
    
    else:  # outline
        return """请对故事大纲进行分析并给出修改建议，要求：

1. 故事结构
   - 评估结构的完整性
   - 分析情节的合理性
   - 检查故事的平衡性

2. 人物设置
   - 主要人物的作用是否明确
   - 人物之间的关系是否合理
   - 人物成长空间是否充足

3. 冲突设计
   - 主要冲突的设置是否合理
   - 次要冲突的铺垫是否充分
   - 冲突的解决是否合适

4. 主题表达
   - 主题是否突出
   - 寓意是否深刻
   - 表达是否自然

请按以上四个方面详细分析并给出具体的修改建议。"""

def get_rewrite_user_prompt(content_type: str, content: str) -> str:
    """
    生成重写用户提示词
    
    Args:
        content_type: 内容类型（outline/characters/content）
        content: 具体内容
        
    Returns:
        重写用户提示词
    """
    type_desc = {
        'outline': '故事大纲',
        'characters': '人物设定',
        'content': '小说内容'
    }
    return f"请对以下{type_desc[content_type]}进行分析并提供修改建议：\n\n{content}"

def get_final_rewrite_prompt() -> str:
    """
    生成最终重写提示词
    
    Returns:
        最终重写提示词
    """
    prompt = """你是一位资深的文学编辑，请对小说进行全面分析，重点关注以下方面：

1. 内容分析：
   - 情节的完整性和连贯性
   - 人物塑造的丰满度
   - 主题表达的深度
   - 细节描写的生动性
   - 对话的真实性

2. 写作风格：
   - 叙事视角的一致性
   - 写作手法的运用
   - 语言风格的统一
   - 情感表达的深度
   - 意象和隐喻的使用

3. 重复内容：
   - 重复的情节
   - 重复的描写
   - 重复的对话
   - 重复的意象

4. 作者风格：
   - 是否符合作者的写作偏好
   - 是否体现作者的特色手法
   - 是否达到预期的写作效果
   - 是否保持风格的一致性

请按照以下格式输出分析结果：

## 内容评价
[详细分析情节、人物、主题等方面]

## 风格评估
[分析写作风格、手法运用等]

## 重复问题
[指出需要去重的内容]

## 改进建议
[具体的修改和优化建议]

## 深化方向
[可以进一步加强的方面]"""
    return prompt

def get_final_rewrite_user_prompt(outline: str, characters: str, content: str) -> str:
    """
    生成最终重写用户提示词
    
    Args:
        outline: 故事大纲
        characters: 人物设定
        content: 小说内容
        
    Returns:
        最终重写用户提示词
    """
    return f"""请根据以下信息对小说进行分析：

【故事大纲】
{outline}

【人物设定】
{characters}

【小说内容】
{content}"""

def get_final_rewrite_fix_prompt(content: str, analysis: str) -> str:
    """
    生成最终重写修复提示词
    
    Args:
        content: 原始内容
        analysis: 分析结果
        
    Returns:
        最终重写修复提示词
    """
    prompt = f"""请根据以下分析结果对小说进行重写：

原文：
{content}

分析结果：
{analysis}

重写要求：
1. 保持故事的核心情节和主题不变
2. 调整不符合大纲的内容
3. 修正人物性格的不一致
4. 改善情节的连贯性
5. 优化部分之间的过渡
6. 加强主题的表达
7. 丰富细节描写
8. 删除或合并重复内容，确保：
   - 不同段落表达不同的内容
   - 避免重复的描写和对话
   - 每个场景都有独特的作用
   - 保持文章的流畅性
9. 严格遵循作者的写作风格：
   - 保持指定的叙事视角
   - 运用作者偏好的写作手法
   - 体现作者的语言特色
   - 突出作者擅长的描写重点
10. 确保写作手法的一致性：
    - 维持统一的时态
    - 保持一致的语气
    - 合理使用各种叙事技巧
    - 注重重点描写内容

请直接输出重写后的完整内容。"""
    return prompt 